from rc4 import *

def test_KSA():
    T_box = [67, 82, 73, 80, 84, 79, 71, 82, 65, 70, 73, 65, 95, 49, 50, 56]
    S_box = [92, 150, 225, 50, 140, 48, 98, 215, 154, 188, 31, 231, 40, 102, 26, 62, 235, 163, 148, 97, 84, 6, 132, 13, 9, 21, 143, 41, 229, 118, 105, 176, 7, 103, 45, 121, 241, 109, 137, 75, 172, 106, 142, 46, 122, 100, 107, 146, 224, 136, 52, 112, 128, 39, 200, 117, 63, 4, 1, 211, 227, 55, 131, 202, 139, 110, 20, 249, 145, 101, 135, 53, 3, 178, 170, 187, 173, 86, 115, 93, 240, 127, 166, 23, 37, 30, 219, 66, 223, 126, 155, 71, 120, 248, 14, 197, 24, 83, 34, 212, 10, 156, 104, 90, 5, 35, 141, 44, 158, 160, 17, 243, 119, 59, 152, 74, 180, 182, 244, 185, 181, 147, 133, 89, 191, 203, 183, 192, 199, 134, 54, 193, 124, 255, 88, 79, 57, 210, 159, 246, 73, 247, 11, 82, 168, 220, 77, 198, 174, 91, 218, 153, 165, 69, 207, 130, 196, 47, 179, 221, 151, 194, 19, 208, 164, 232, 144, 230, 8, 253, 217, 18, 38, 216, 254, 108, 206, 233, 58, 0, 25, 67, 81, 70, 96, 177, 242, 238, 85, 60, 22, 195, 125, 237, 87, 251, 201, 113, 209, 61, 123, 169, 16, 171, 252, 236, 205, 15, 32, 228, 167, 72, 29, 184, 222, 129, 161, 80, 204, 157, 27, 68, 2, 12, 111, 138, 245, 149, 234, 65, 99, 189, 250, 36, 28, 64, 186, 49, 162, 175, 116, 239, 95, 42, 51, 214, 78, 33, 43, 76, 213, 56, 114, 94, 226, 190]
    assert KSA(T_box) == S_box

# def test_PRGA():
#     S_box = [92, 150, 225, 50, 140, 48, 98, 215, 154, 188, 31, 231, 40, 102, 26, 62, 235, 163, 148, 97, 84, 6, 132, 13, 9, 21, 143, 41, 229, 118, 105, 176, 7, 103, 45, 121, 241, 109, 137, 75, 172, 106, 142, 46, 122, 100, 107, 146, 224, 136, 52, 112, 128, 39, 200, 117, 63, 4, 1, 211, 227, 55, 131, 202, 139, 110, 20, 249, 145, 101, 135, 53, 3, 178, 170, 187, 173, 86, 115, 93, 240, 127, 166, 23, 37, 30, 219, 66, 223, 126, 155, 71, 120, 248, 14, 197, 24, 83, 34, 212, 10, 156, 104, 90, 5, 35, 141, 44, 158, 160, 17, 243, 119, 59, 152, 74, 180, 182, 244, 185, 181, 147, 133, 89, 191, 203, 183, 192, 199, 134, 54, 193, 124, 255, 88, 79, 57, 210, 159, 246, 73, 247, 11, 82, 168, 220, 77, 198, 174, 91, 218, 153, 165, 69, 207, 130, 196, 47, 179, 221, 151, 194, 19, 208, 164, 232, 144, 230, 8, 253, 217, 18, 38, 216, 254, 108, 206, 233, 58, 0, 25, 67, 81, 70, 96, 177, 242, 238, 85, 60, 22, 195, 125, 237, 87, 251, 201, 113, 209, 61, 123, 169, 16, 171, 252, 236, 205, 15, 32, 228, 167, 72, 29, 184, 222, 129, 161, 80, 204, 157, 27, 68, 2, 12, 111, 138, 245, 149, 234, 65, 99, 189, 250, 36, 28, 64, 186, 49, 162, 175, 116, 239, 95, 42, 51, 214, 78, 33, 43, 76, 213, 56, 114, 94, 226, 190]
#     assert type(PRGA(S_box)) == generator

def test_encrypt_text():
    assert encrypt('CRIPTOGRAFIA_128', 'curso_cripto') == '14BAE0739382FC22C6B72171'

def test_decrypt_text():
    assert decrypt('CRIPTOGRAFIA_128', '14BAE0739382FC22C6B72171') == 'curso_cripto'